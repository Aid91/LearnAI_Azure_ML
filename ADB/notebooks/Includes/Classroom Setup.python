{"version":"NotebookV1","origId":3771102850753733,"name":"Classroom Setup","language":"python","commands":[{"version":"CommandV1","origId":3771102850753734,"guid":"5c72f44c-1083-49e3-8683-7c3329b55a88","subtype":"command","commandType":"auto","position":1.0,"command":"%run \"./Setup Environment\"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"5858075836730959","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"48d04502-42c3-40c7-80f2-8c55b53f6243"},{"version":"CommandV1","origId":3771102850753735,"guid":"b76d3e2c-1282-49f5-acb1-740e662229b3","subtype":"command","commandType":"auto","position":2.0,"command":"%run \"./Dataset Mounts\"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"5858075836730959","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"53fcf90c-8caa-43bd-91a0-96e0575e66af"},{"version":"CommandV1","origId":3771102850753736,"guid":"61e4fb2d-53d8-44af-8d1c-54c5f3d29a56","subtype":"command","commandType":"auto","position":3.0,"command":"%scala\n\n//*******************************************\n// CHECK FOR REQUIRED VERIONS OF SPARK & DBR\n//*******************************************\n\nval dbrVersion = assertDbrVersion(4, 0)\nval sparkVersion = assertSparkVersion(2, 3)\n\ndisplayHTML(s\"\"\"\nChecking versions...\n  <li>Spark: $sparkVersion</li>\n  <li>DBR: $dbrVersion</li>\n  <li>Scala: $scalaVersion</li>\n  <li>Python: ${spark.conf.get(\"com.databricks.training.python-version\")}</li>\n\"\"\")\n\n//*******************************************\n// ILT Specific functions\n//*******************************************\n\n// Utility method to count & print the number of records in each partition.\ndef printRecordsPerPartition(df:org.apache.spark.sql.Dataset[Row]):Unit = {\n  import org.apache.spark.sql.functions._\n  println(\"Per-Partition Counts:\")\n  val results = df.rdd                                   // Convert to an RDD\n    .mapPartitions(it => Array(it.size).iterator, true)  // For each partition, count\n    .collect()                                           // Return the counts to the driver\n\n  results.foreach(x => println(\"* \" + x))\n}","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"5858075836730959","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5e788630-b013-404d-a773-a808f8e0d8e3"},{"version":"CommandV1","origId":3771102850753737,"guid":"a08c272e-c1c8-49d3-b856-d63124333f18","subtype":"command","commandType":"auto","position":4.0,"command":"%python\n\ndbrVersion = assertDbrVersion(4, 0)\nsparkVersion = assertSparkVersion(2, 3)\n\n#*******************************************\n# ILT Specific functions\n#*******************************************\n\n# Utility method to count & print the number of records in each partition.\ndef printRecordsPerPartition(df):\n  print(\"Per-Partition Counts:\")\n  def countInPartition(iterator): yield __builtin__.sum(1 for _ in iterator)\n  results = (df.rdd                   # Convert to an RDD\n    .mapPartitions(countInPartition)  # For each partition, count\n    .collect()                        # Return the counts to the driver\n  )\n  # Print out the results.\n  for result in results: print(\"* \" + str(result))\n\nNone # suppress output","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"5858075836730959","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2c5798e1-a0ac-4111-b966-2503c05daacc"},{"version":"CommandV1","origId":3771102850753738,"guid":"8ecc3a31-e2f9-45be-a13e-4fa80dce83ba","subtype":"command","commandType":"auto","position":5.0,"command":"%scala\ndisplayHTML(\"All done!\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"5858075836730959","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"127e8148-711f-40cc-8c32-f68ceba4f99d"}],"dashboards":[],"guid":"05ed48d0-621b-45b3-8cc0-13f5ad2a886e","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}
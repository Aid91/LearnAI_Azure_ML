{"version":"NotebookV1","origId":2949404636185963,"name":"01_logistic_regression","language":"python","commands":[{"version":"CommandV1","origId":2949404636185965,"guid":"1f417595-dc9e-4521-ba7a-14c490f59c15","subtype":"command","commandType":"auto","position":2.0,"command":"%md-sandbox\n#Logistic Regression Lab","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a6a6c653-93e5-47a1-9180-4b8eeaeacb75"},{"version":"CommandV1","origId":2949404636185966,"guid":"39359a6b-6031-4dd4-92d4-3271d941195a","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n##![Spark Logo Tiny](https://files.training.databricks.com/images/105/logo_spark_tiny.png) Getting Started\n\nRun the following cell to configure our \"classroom.\"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"80bfba1d-b98a-4c1d-80b0-fc7a3d61ca19"},{"version":"CommandV1","origId":2949404636185967,"guid":"ab8200e3-c7b5-4986-aca3-83665741fceb","subtype":"command","commandType":"auto","position":4.0,"command":"%run \"../includes/env_setup\"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":1547172196504,"submitTime":1547172196504,"finishTime":1547172212928,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e8bbc828-6120-4c3f-8552-96d307fb87b5"},{"version":"CommandV1","origId":2949404636185968,"guid":"244ff0fe-da28-4326-a01a-13456e22d58d","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n##![Spark Logo Tiny](https://files.training.databricks.com/images/105/logo_spark_tiny.png) Reading the data","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0166f27e-52a4-4327-8c7d-4adbc52f0726"},{"version":"CommandV1","origId":2949404636185969,"guid":"e44da987-8319-46f3-80b9-bdc2cf0a44b4","subtype":"command","commandType":"auto","position":6.0,"command":"import urllib.request # for downloading data\nimport os\n\ncontainer_url = 'https://sethmottstore.blob.core.windows.net/predmaint/'\ndata_dir = '/dbfs/tmp/data'\nos.makedirs(data_dir, exist_ok=True)\n\nfor filename in ['X_train.csv', 'X_test.csv', 'y_train.csv', 'y_test.csv']:\n  if not os.path.exists(os.path.join('/dbfs/tmp/data/', filename)):\n    urllib.request.urlretrieve(container_url + filename, filename=os.path.join(data_dir, filename))\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547172212695,"submitTime":1547172196793,"finishTime":1547172213379,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fa940758-a816-435f-8d77-22ccd6a6de4a"},{"version":"CommandV1","origId":2949404636185970,"guid":"d9af3d64-0a17-4682-8d19-c1a348104c0f","subtype":"command","commandType":"auto","position":7.0,"command":"display(trainDF.describe())","commandVersion":0,"state":"finished","results":{"type":"table","data":[["count","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200","218200"],["mean","170.79142816074224","446.67018945726926","100.82473057074422","40.39636621482396","13.294366730045626","44.46570129464604","8.882569520551101","4.441315734506562","170.7921291908804","446.66782590070864","100.82646106628229","40.39670769314322","14.685678550545523","49.138900077301955","9.852978778990508","4.917782424327237","0.007552703941338222","0.007076076993583868","0.00615032080659945","0.005270394133822181","0.002974335472043996","734.7263015582034","723.5331530705774","879.740609532539","996.4734005499541","1577.1228505957836","0.005238313473877177","0.005714940421631531","0.005206232813932172","0.005348304307974335","865.2095142071494","802.331906507791","841.8799908340972","877.5255728689276","1981.4430109990833","1819.0871631530706","2567.6038817598533","2287.3277818515126","11.33","0.011594867094408799","0.01453712190650779","0.007919340054995417","0.010692025664527956"],["stddev","9.482203654220843","32.966534131107544","7.381424362140375","3.489703480063859","6.967975574523699","23.258371110140352","4.653639165731734","2.3238603627008483","5.750827093704814","21.167525241785803","5.298272398713517","2.385414384631596","3.1938468308081487","10.647324265870454","2.206873026373227","1.0823304129153994","0.08657768163284676","0.08382146698762241","0.07818262194355254","0.07240608473233351","0.054456426538078466","740.7164744176084","683.1933919899699","927.8780949413745","984.4077600976592","1413.475610535006","0.07218654602567116","0.0753810713597301","0.07196632330208276","0.07293644033706205","834.1468532574854","752.4583794753779","761.2246507691599","873.1995477161997","1586.070198830675","1507.7933311951535","1919.546134305263","1844.9554904836973","5.827628646609599","0.10705362522721416","0.11969068321261249","0.08863780296679513","0.10284821208486374"],["min","130.02944600397623","194.464557202404","73.69884859097029","26.996772808950066","0.042314791146016745","0.06975399862157544","0.017929672765896666","0.0216392342434398","151.98170521159378","258.5808385961039","86.51473450702103","33.99944874912691","3.3367044485829895","12.1612110411332","2.1509147301103155","1.1671195688851876","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0","0","0","0","0"],["max","232.26596624744408","588.5983965182577","166.19004733638818","66.91622138821118","59.43921012371967","179.25778213453023","36.313173795828924","19.16687563701065","221.46598472277208","520.8098455162843","156.6015598275391","63.31483235524369","32.98612274893437","115.02910801305806","26.37349337713676","13.712219675897703","1.0","1.0","1.0","1.0","1.0","5379.0","4884.0","6543.0","6513.0","6543.0","1.0","1.0","1.0","1.0","6543.0","5034.0","5394.0","6543.0","6543.0","6543.0","6543.0","6543.0","20","1","1","1","1"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"summary","type":"\"string\"","metadata":"{}"},{"name":"volt_ma_3","type":"\"string\"","metadata":"{}"},{"name":"rotate_ma_3","type":"\"string\"","metadata":"{}"},{"name":"pressure_ma_3","type":"\"string\"","metadata":"{}"},{"name":"vibration_ma_3","type":"\"string\"","metadata":"{}"},{"name":"volt_sd_3","type":"\"string\"","metadata":"{}"},{"name":"rotate_sd_3","type":"\"string\"","metadata":"{}"},{"name":"pressure_sd_3","type":"\"string\"","metadata":"{}"},{"name":"vibration_sd_3","type":"\"string\"","metadata":"{}"},{"name":"volt_ma_12","type":"\"string\"","metadata":"{}"},{"name":"rotate_ma_12","type":"\"string\"","metadata":"{}"},{"name":"pressure_ma_12","type":"\"string\"","metadata":"{}"},{"name":"vibration_ma_12","type":"\"string\"","metadata":"{}"},{"name":"volt_sd_12","type":"\"string\"","metadata":"{}"},{"name":"rotate_sd_12","type":"\"string\"","metadata":"{}"},{"name":"pressure_sd_12","type":"\"string\"","metadata":"{}"},{"name":"vibration_sd_12","type":"\"string\"","metadata":"{}"},{"name":"e_1","type":"\"string\"","metadata":"{}"},{"name":"e_2","type":"\"string\"","metadata":"{}"},{"name":"e_3","type":"\"string\"","metadata":"{}"},{"name":"e_4","type":"\"string\"","metadata":"{}"},{"name":"e_5","type":"\"string\"","metadata":"{}"},{"name":"de_1","type":"\"string\"","metadata":"{}"},{"name":"de_2","type":"\"string\"","metadata":"{}"},{"name":"de_3","type":"\"string\"","metadata":"{}"},{"name":"de_4","type":"\"string\"","metadata":"{}"},{"name":"de_5","type":"\"string\"","metadata":"{}"},{"name":"m_1","type":"\"string\"","metadata":"{}"},{"name":"m_2","type":"\"string\"","metadata":"{}"},{"name":"m_3","type":"\"string\"","metadata":"{}"},{"name":"m_4","type":"\"string\"","metadata":"{}"},{"name":"dm_1","type":"\"string\"","metadata":"{}"},{"name":"dm_2","type":"\"string\"","metadata":"{}"},{"name":"dm_3","type":"\"string\"","metadata":"{}"},{"name":"dm_4","type":"\"string\"","metadata":"{}"},{"name":"df_1","type":"\"string\"","metadata":"{}"},{"name":"df_2","type":"\"string\"","metadata":"{}"},{"name":"df_3","type":"\"string\"","metadata":"{}"},{"name":"df_4","type":"\"string\"","metadata":"{}"},{"name":"age","type":"\"string\"","metadata":"{}"},{"name":"y_1","type":"\"string\"","metadata":"{}"},{"name":"y_2","type":"\"string\"","metadata":"{}"},{"name":"y_3","type":"\"string\"","metadata":"{}"},{"name":"y_4","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":"<span class=\"ansired\">Exception</span>: Cannot call display(&lt;class &apos;method&apos;&gt;)","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Exception</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2949404636185970&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>display<span class=\"ansiyellow\">(</span>trainDF<span class=\"ansiyellow\">.</span>describe<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/local_disk0/tmp/1547172203044-0/PythonShell.py</span> in <span class=\"ansicyan\">display</span><span class=\"ansiblue\">(self, input, *args, **kwargs)</span>\n<span class=\"ansigreen\">    860</span>             input<span class=\"ansiyellow\">.</span>help<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span> <span class=\"ansired\"># This is going to display the help as a side-effect</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    861</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 862</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">raise</span> Exception<span class=\"ansiyellow\">(</span>genericErrorMsg<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    863</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    864</span>     <span class=\"ansigreen\">def</span> displayHTML<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> html<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">Exception</span>: Cannot call display(&lt;class &apos;method&apos;&gt;)\n Call help(display) for more info.</div>","workflows":[],"startTime":1547172247617,"submitTime":1547172247587,"finishTime":1547172264935,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d31ed02e-d246-4f7b-b9a4-89ae68ea00dd"},{"version":"CommandV1","origId":2949404636185971,"guid":"698ba194-407c-4479-a18f-9b155f47475b","subtype":"command","commandType":"auto","position":8.0,"command":"%md\nIn the previous lab we preserved the `price_raw` attribute, but we don't need it for modeling. Let's drop it.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0de603c5-531c-4fc8-a308-e9dbaf21c49f"},{"version":"CommandV1","origId":2949404636185972,"guid":"d72c6634-1c23-4b4d-8c00-db6de4588f09","subtype":"command","commandType":"auto","position":9.0,"command":"trainDF = trainDF.drop(\"y_2\",\"y_3\",\"y_4\")\ntrainDF = trainDF.withColumnRenamed(\"y_1\", \"error\")\ntrainDF.cache()\n\ntestDF = testDF.drop(\"y_2\",\"y_3\",\"y_4\")\ntestDF = testDF.withColumnRenamed(\"y_1\", \"error\")\ntestDF.cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">15</span><span class=\"ansired\">]: </span>DataFrame[volt_ma_3: double, rotate_ma_3: double, pressure_ma_3: double, vibration_ma_3: double, volt_sd_3: double, rotate_sd_3: double, pressure_sd_3: double, vibration_sd_3: double, volt_ma_12: double, rotate_ma_12: double, pressure_ma_12: double, vibration_ma_12: double, volt_sd_12: double, rotate_sd_12: double, pressure_sd_12: double, vibration_sd_12: double, e_1: double, e_2: double, e_3: double, e_4: double, e_5: double, de_1: double, de_2: double, de_3: double, de_4: double, de_5: double, m_1: double, m_2: double, m_3: double, m_4: double, dm_1: double, dm_2: double, dm_3: double, dm_4: double, df_1: double, df_2: double, df_3: double, df_4: double, age: int, error: int]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"trainDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"volt_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"e_1","nullable":true,"type":"double"},{"metadata":{},"name":"e_2","nullable":true,"type":"double"},{"metadata":{},"name":"e_3","nullable":true,"type":"double"},{"metadata":{},"name":"e_4","nullable":true,"type":"double"},{"metadata":{},"name":"e_5","nullable":true,"type":"double"},{"metadata":{},"name":"de_1","nullable":true,"type":"double"},{"metadata":{},"name":"de_2","nullable":true,"type":"double"},{"metadata":{},"name":"de_3","nullable":true,"type":"double"},{"metadata":{},"name":"de_4","nullable":true,"type":"double"},{"metadata":{},"name":"de_5","nullable":true,"type":"double"},{"metadata":{},"name":"m_1","nullable":true,"type":"double"},{"metadata":{},"name":"m_2","nullable":true,"type":"double"},{"metadata":{},"name":"m_3","nullable":true,"type":"double"},{"metadata":{},"name":"m_4","nullable":true,"type":"double"},{"metadata":{},"name":"dm_1","nullable":true,"type":"double"},{"metadata":{},"name":"dm_2","nullable":true,"type":"double"},{"metadata":{},"name":"dm_3","nullable":true,"type":"double"},{"metadata":{},"name":"dm_4","nullable":true,"type":"double"},{"metadata":{},"name":"df_1","nullable":true,"type":"double"},{"metadata":{},"name":"df_2","nullable":true,"type":"double"},{"metadata":{},"name":"df_3","nullable":true,"type":"double"},{"metadata":{},"name":"df_4","nullable":true,"type":"double"},{"metadata":{},"name":"age","nullable":true,"type":"integer"},{"metadata":{},"name":"error","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null},{"name":"testDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"volt_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"e_1","nullable":true,"type":"double"},{"metadata":{},"name":"e_2","nullable":true,"type":"double"},{"metadata":{},"name":"e_3","nullable":true,"type":"double"},{"metadata":{},"name":"e_4","nullable":true,"type":"double"},{"metadata":{},"name":"e_5","nullable":true,"type":"double"},{"metadata":{},"name":"de_1","nullable":true,"type":"double"},{"metadata":{},"name":"de_2","nullable":true,"type":"double"},{"metadata":{},"name":"de_3","nullable":true,"type":"double"},{"metadata":{},"name":"de_4","nullable":true,"type":"double"},{"metadata":{},"name":"de_5","nullable":true,"type":"double"},{"metadata":{},"name":"m_1","nullable":true,"type":"double"},{"metadata":{},"name":"m_2","nullable":true,"type":"double"},{"metadata":{},"name":"m_3","nullable":true,"type":"double"},{"metadata":{},"name":"m_4","nullable":true,"type":"double"},{"metadata":{},"name":"dm_1","nullable":true,"type":"double"},{"metadata":{},"name":"dm_2","nullable":true,"type":"double"},{"metadata":{},"name":"dm_3","nullable":true,"type":"double"},{"metadata":{},"name":"dm_4","nullable":true,"type":"double"},{"metadata":{},"name":"df_1","nullable":true,"type":"double"},{"metadata":{},"name":"df_2","nullable":true,"type":"double"},{"metadata":{},"name":"df_3","nullable":true,"type":"double"},{"metadata":{},"name":"df_4","nullable":true,"type":"double"},{"metadata":{},"name":"age","nullable":true,"type":"integer"},{"metadata":{},"name":"error","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547172459000,"submitTime":1547172458978,"finishTime":1547172459080,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7f7ad96b-03a4-41d9-8c33-2dd05bc914f3"},{"version":"CommandV1","origId":2949404636185973,"guid":"712dc3f4-ec79-40d6-965f-e6fd2860b3e7","subtype":"command","commandType":"auto","position":10.0,"command":"%md\nLet's make sure we don't have any null values in our DataFrame","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b04bda2d-7608-4fa0-82e8-86bcbed98d7c"},{"version":"CommandV1","origId":2949404636185974,"guid":"eecba5ab-bf18-402f-827e-971531b9393e","subtype":"command","commandType":"auto","position":11.0,"command":"recordCount = trainDF.count()\nnoNullsRecordCount = trainDF.na.drop().count()\n\nprint(\"We have {} records that contain null values.\".format(recordCount - noNullsRecordCount))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">We have 0 records that contain null values.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547172342807,"submitTime":1547172342772,"finishTime":1547172345240,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2efe06d1-ffe0-49b2-907e-b306ef306493"},{"version":"CommandV1","origId":2949404636185986,"guid":"5aa19051-ac82-450a-b960-7a83f9bf2d4c","subtype":"command","commandType":"auto","position":23.0,"command":"display(trainDF.groupBy(\"error\").count())","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1,2530],[0,215670]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"error","type":"\"integer\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: &quot;cannot resolve &apos;&#96;error&#96;&apos; given input columns: [pressure_sd_12, de_1, volt_sd_3, m_1, vibration_sd_12, vibration_ma_12, vibration_ma_3, m_2, e_3, dm_2, y_1, df_1, de_5, df_2, e_2, pressure_ma_12, pressure_sd_3, dm_4, volt_sd_12, rotate_sd_12, volt_ma_12, e_5, df_4, vibration_sd_3, de_3, rotate_ma_12, dm_1, age, e_4, rotate_ma_3, volt_ma_3, de_4, de_2, df_3, m_3, m_4, dm_3, e_1, rotate_sd_3, pressure_ma_3];;\\n&apos;Aggregate [&apos;error], [&apos;error, count(1) AS count#5848L]\\n+- Project [volt_ma_3#276, rotate_ma_3#277, pressure_ma_3#278, vibration_ma_3#279, volt_sd_3#280, rotate_sd_3#281, pressure_sd_3#282, vibration_sd_3#283, volt_ma_12#284, rotate_ma_12#285, pressure_ma_12#286, vibration_ma_12#287, volt_sd_12#288, rotate_sd_12#289, pressure_sd_12#290, vibration_sd_12#291, e_1#292, e_2#293, e_3#294, e_4#295, e_5#296, de_1#297, de_2#298, de_3#299, ... 16 more fields]\\n   +- Project [volt_ma_3#276, rotate_ma_3#277, pressure_ma_3#278, vibration_ma_3#279, volt_sd_3#280, rotate_sd_3#281, pressure_sd_3#282, vibration_sd_3#283, volt_ma_12#284, rotate_ma_12#285, pressure_ma_12#286, vibration_ma_12#287, volt_sd_12#288, rotate_sd_12#289, pressure_sd_12#290, vibration_sd_12#291, e_1#292, e_2#293, e_3#294, e_4#295, e_5#296, de_1#297, de_2#298, de_3#299, ... 19 more fields]\\n      +- Join Inner, (ColumnIndex#315L = ColumnIndex#364L)\\n         :- LogicalRDD [volt_ma_3#276, rotate_ma_3#277, pressure_ma_3#278, vibration_ma_3#279, volt_sd_3#280, rotate_sd_3#281, pressure_sd_3#282, vibration_sd_3#283, volt_ma_12#284, rotate_ma_12#285, pressure_ma_12#286, vibration_ma_12#287, volt_sd_12#288, rotate_sd_12#289, pressure_sd_12#290, vibration_sd_12#291, e_1#292, e_2#293, e_3#294, e_4#295, e_5#296, de_1#297, de_2#298, de_3#299, ... 16 more fields], false\\n         +- LogicalRDD [y_1#360, y_2#361, y_3#362, y_4#363, ColumnIndex#364L], false\\n&quot;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2949404636185986&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>display<span class=\"ansiyellow\">(</span>trainDF<span class=\"ansiyellow\">.</span>groupBy<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;error&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/group.py</span> in <span class=\"ansicyan\">_api</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">     30</span>     <span class=\"ansigreen\">def</span> _api<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     31</span>         name <span class=\"ansiyellow\">=</span> f<span class=\"ansiyellow\">.</span>__name__<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 32</span><span class=\"ansiyellow\">         </span>jdf <span class=\"ansiyellow\">=</span> getattr<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jgd<span class=\"ansiyellow\">,</span> name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     33</span>         <span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>jdf<span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     34</span>     _api<span class=\"ansiyellow\">.</span>__name__ <span class=\"ansiyellow\">=</span> f<span class=\"ansiyellow\">.</span>__name__<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1255</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1256</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1257</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1258</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1259</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: &quot;cannot resolve &apos;&#96;error&#96;&apos; given input columns: [pressure_sd_12, de_1, volt_sd_3, m_1, vibration_sd_12, vibration_ma_12, vibration_ma_3, m_2, e_3, dm_2, y_1, df_1, de_5, df_2, e_2, pressure_ma_12, pressure_sd_3, dm_4, volt_sd_12, rotate_sd_12, volt_ma_12, e_5, df_4, vibration_sd_3, de_3, rotate_ma_12, dm_1, age, e_4, rotate_ma_3, volt_ma_3, de_4, de_2, df_3, m_3, m_4, dm_3, e_1, rotate_sd_3, pressure_ma_3];;\\n&apos;Aggregate [&apos;error], [&apos;error, count(1) AS count#5848L]\\n+- Project [volt_ma_3#276, rotate_ma_3#277, pressure_ma_3#278, vibration_ma_3#279, volt_sd_3#280, rotate_sd_3#281, pressure_sd_3#282, vibration_sd_3#283, volt_ma_12#284, rotate_ma_12#285, pressure_ma_12#286, vibration_ma_12#287, volt_sd_12#288, rotate_sd_12#289, pressure_sd_12#290, vibration_sd_12#291, e_1#292, e_2#293, e_3#294, e_4#295, e_5#296, de_1#297, de_2#298, de_3#299, ... 16 more fields]\\n   +- Project [volt_ma_3#276, rotate_ma_3#277, pressure_ma_3#278, vibration_ma_3#279, volt_sd_3#280, rotate_sd_3#281, pressure_sd_3#282, vibration_sd_3#283, volt_ma_12#284, rotate_ma_12#285, pressure_ma_12#286, vibration_ma_12#287, volt_sd_12#288, rotate_sd_12#289, pressure_sd_12#290, vibration_sd_12#291, e_1#292, e_2#293, e_3#294, e_4#295, e_5#296, de_1#297, de_2#298, de_3#299, ... 19 more fields]\\n      +- Join Inner, (ColumnIndex#315L = ColumnIndex#364L)\\n         :- LogicalRDD [volt_ma_3#276, rotate_ma_3#277, pressure_ma_3#278, vibration_ma_3#279, volt_sd_3#280, rotate_sd_3#281, pressure_sd_3#282, vibration_sd_3#283, volt_ma_12#284, rotate_ma_12#285, pressure_ma_12#286, vibration_ma_12#287, volt_sd_12#288, rotate_sd_12#289, pressure_sd_12#290, vibration_sd_12#291, e_1#292, e_2#293, e_3#294, e_4#295, e_5#296, de_1#297, de_2#298, de_3#299, ... 16 more fields], false\\n         +- LogicalRDD [y_1#360, y_2#361, y_3#362, y_4#363, ColumnIndex#364L], false\\n&quot;</div>","workflows":[],"startTime":1547172466015,"submitTime":1547172465984,"finishTime":1547172468315,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d7f677ba-e54f-44b2-af1e-5cc0ba4f3d82"},{"version":"CommandV1","origId":2949404636185991,"guid":"39cb4562-defd-4050-9a99-66385d1f1f8b","subtype":"command","commandType":"auto","position":28.0,"command":"%md\n## Train a Logistic Regression Model\n\nBefore we can apply the logistic regression model, we will need to do some data preparation, such as one hot encoding our categorical variables using `StringIndexer` and `OneHotEncoderEstimator`.\n\nLet's start by taking a look at all of our columns, and determine which ones are categorical.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d3432335-2725-42b8-97f0-0eeea4507e22"},{"version":"CommandV1","origId":2949404636185992,"guid":"d3e495d4-ecd6-4336-b2fc-26ad5ad8e951","subtype":"command","commandType":"auto","position":29.0,"command":"trainDF.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- volt_ma_3: double (nullable = true)\n |-- rotate_ma_3: double (nullable = true)\n |-- pressure_ma_3: double (nullable = true)\n |-- vibration_ma_3: double (nullable = true)\n |-- volt_sd_3: double (nullable = true)\n |-- rotate_sd_3: double (nullable = true)\n |-- pressure_sd_3: double (nullable = true)\n |-- vibration_sd_3: double (nullable = true)\n |-- volt_ma_12: double (nullable = true)\n |-- rotate_ma_12: double (nullable = true)\n |-- pressure_ma_12: double (nullable = true)\n |-- vibration_ma_12: double (nullable = true)\n |-- volt_sd_12: double (nullable = true)\n |-- rotate_sd_12: double (nullable = true)\n |-- pressure_sd_12: double (nullable = true)\n |-- vibration_sd_12: double (nullable = true)\n |-- e_1: double (nullable = true)\n |-- e_2: double (nullable = true)\n |-- e_3: double (nullable = true)\n |-- e_4: double (nullable = true)\n |-- e_5: double (nullable = true)\n |-- de_1: double (nullable = true)\n |-- de_2: double (nullable = true)\n |-- de_3: double (nullable = true)\n |-- de_4: double (nullable = true)\n |-- de_5: double (nullable = true)\n |-- m_1: double (nullable = true)\n |-- m_2: double (nullable = true)\n |-- m_3: double (nullable = true)\n |-- m_4: double (nullable = true)\n |-- dm_1: double (nullable = true)\n |-- dm_2: double (nullable = true)\n |-- dm_3: double (nullable = true)\n |-- dm_4: double (nullable = true)\n |-- df_1: double (nullable = true)\n |-- df_2: double (nullable = true)\n |-- df_3: double (nullable = true)\n |-- df_4: double (nullable = true)\n |-- age: integer (nullable = true)\n |-- error: integer (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547172522829,"submitTime":1547172522812,"finishTime":1547172522853,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d3b8d8d3-bc57-4b6b-a8ce-8d58d247dbeb"},{"version":"CommandV1","origId":2949404636186005,"guid":"4466957d-16e7-45b9-84d2-1d7ac1bdb448","subtype":"command","commandType":"auto","position":42.0,"command":"%md\n## Pipeline\n\nLet's build some of the transformations we'll need in our pipeline, such as `VectorAssembler` and LogisticRegression`.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9d923c83-64c3-4322-b5f1-137d4efa90f2"},{"version":"CommandV1","origId":2949404636186007,"guid":"df0bd2f0-20ef-44f7-8f87-291fde7213cf","subtype":"command","commandType":"auto","position":44.0,"command":"%md\nSet the input columns of the `VectorAssembler` to `featureCols`, the output column to `features` and create a `LinearRegression` that uses the `price` as label. :\n\n * <a href=\"https://spark.apache.org/docs/latest/ml-features.html#vectorassembler\" target=\"_blank\">VectorAssembler Docs</a>\n * <a href=\"https://spark.apache.org/docs/latest/ml-classification-regression.html#logistic-regression\" target=\"_blank\">Logistic Regression Docs</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"83494a66-1fa8-441b-afd3-05091774bed9"},{"version":"CommandV1","origId":2949404636186008,"guid":"64188f19-5e10-4231-ac59-10e0ec070709","subtype":"command","commandType":"auto","position":45.0,"command":"from pyspark.ml.feature import VectorAssembler\nfrom pyspark.ml.classification import LogisticRegression\n\nlr = (LogisticRegression()\n      .setLabelCol(\"error\")\n      .setFeaturesCol(\"features\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">ImportError</span>: cannot import name &apos;LogisticRegression&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">ImportError</span>                               Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2949404636186008&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>ml<span class=\"ansiyellow\">.</span>feature <span class=\"ansigreen\">import</span> VectorAssembler<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 4</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>ml<span class=\"ansiyellow\">.</span>regression <span class=\"ansigreen\">import</span> LogisticRegression<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      6</span> <span class=\"ansired\">#assembler = VectorAssembler(&lt;FILL_IN&gt;)</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">ImportError</span>: cannot import name &apos;LogisticRegression&apos;</div>","workflows":[],"startTime":1547179711659,"submitTime":1547179711621,"finishTime":1547179711690,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8e9313b4-25b8-4183-8792-b014fea92349"},{"version":"CommandV1","origId":2949404636186011,"guid":"7a581d19-ab48-4fed-a027-1af75c664d47","subtype":"command","commandType":"auto","position":48.0,"command":"%md\nTest your solution:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b8b8952d-bb37-4925-bf35-e096fdf7537d"},{"version":"CommandV1","origId":2949404636186012,"guid":"2171061f-ed1c-4889-ad83-96a0d02de6c0","subtype":"command","commandType":"auto","position":49.0,"command":"assert len(pipeline.getStages()) == 3, \"Expected 3 stages in the pipeline. VectorAssembler, vectorIndexer and the Logistic Regression\"\n\nprint(\"Tests passed.\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Tests passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AssertionError</span>: Expected 5 stages in the pipeline. 5 StringIndexers, the OneHotEncoredEstimator, the VectorAssembler and the Linear Regression","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AssertionError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2949404636186012&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">assert</span> len<span class=\"ansiyellow\">(</span>pipeline<span class=\"ansiyellow\">.</span>getStages<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">==</span> <span class=\"ansicyan\">5</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;Expected 5 stages in the pipeline. 5 StringIndexers, the OneHotEncoredEstimator, the VectorAssembler and the Linear Regression&quot;</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> print<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Tests passed.&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AssertionError</span>: Expected 5 stages in the pipeline. 5 StringIndexers, the OneHotEncoredEstimator, the VectorAssembler and the Linear Regression</div>","workflows":[],"startTime":1547173223966,"submitTime":1547173223954,"finishTime":1547173223990,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"88ebaf76-bbcc-4b15-b6f0-3c4c7a8cc882"},{"version":"CommandV1","origId":2949404636186013,"guid":"4ad9e85b-8d69-49d8-9c0b-1ce6469b0c7c","subtype":"command","commandType":"auto","position":50.0,"command":"%md\nLet's apply the model to our held-out test set.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c9b349f3-510a-4403-b0c9-66b1e23002a8"},{"version":"CommandV1","origId":2949404636186015,"guid":"a49ce7e3-9275-4bd1-b09d-211e598ee378","subtype":"command","commandType":"auto","position":52.0,"command":"%md\n##![Spark Logo Tiny](https://files.training.databricks.com/images/105/logo_spark_tiny.png) Evaluate the Model","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7c9e10b2-5df8-46b5-9a17-58d8c594aba0"},{"version":"CommandV1","origId":2949404636186016,"guid":"bfabfd04-bee9-4db1-960b-d609f7c866fb","subtype":"command","commandType":"auto","position":53.0,"command":"from pyspark.ml.evaluation import BinaryClassificationEvaluator\n\nevaluator = BinaryClassificationEvaluator()\nprint(evaluator.explainParams())","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">labelCol: label column name. (default: label)\nmetricName: metric name in evaluation (areaUnderROC|areaUnderPR) (default: areaUnderROC)\nrawPredictionCol: raw prediction (a.k.a. confidence) column name. (default: rawPrediction)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547173515509,"submitTime":1547173515476,"finishTime":1547173515546,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d8853562-848c-477d-981d-147dc3aca1fe"},{"version":"CommandV1","origId":2949404636186017,"guid":"4eafac43-b424-4999-b9d9-1ecc85daa4e9","subtype":"command","commandType":"auto","position":54.0,"command":"evaluator.setLabelCol(\"error\")\nevaluator.setRawPredictionCol('rawPrediction')\n\nmetricName = evaluator.getMetricName()\nmetricVal = evaluator.evaluate(predictedDF)\n\nprint(\"{}: {}\".format(metricName, metricVal))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">areaUnderROC: 0.9691911699152621\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: setRawPredictionCol() got an unexpected keyword argument &apos;rawPredictionCol&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-2949404636186017&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> evaluator<span class=\"ansiyellow\">.</span>setLabelCol<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;error&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>evaluator<span class=\"ansiyellow\">.</span>setRawPredictionCol<span class=\"ansiyellow\">(</span>rawPredictionCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&apos;rawPrediction&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> metricName <span class=\"ansiyellow\">=</span> evaluator<span class=\"ansiyellow\">.</span>getMetricName<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> metricVal <span class=\"ansiyellow\">=</span> evaluator<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>predictedDF<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: setRawPredictionCol() got an unexpected keyword argument &apos;rawPredictionCol&apos;</div>","workflows":[],"startTime":1547173594342,"submitTime":1547173594328,"finishTime":1547173603702,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"26866ffd-a565-4fa7-9eae-d6c0f6dd446f"},{"version":"CommandV1","origId":2949404636186018,"guid":"eef080cc-94dd-4064-880e-437da053b1e0","subtype":"command","commandType":"auto","position":55.0,"command":"%md\nWe could wrap this into a function to make it easier to get the output of multiple metrics.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4846ab23-6532-4e1f-b13f-93e226405977"},{"version":"CommandV1","origId":2949404636186019,"guid":"198acf06-c43e-4819-b4fe-f8cec8e8911e","subtype":"command","commandType":"auto","position":56.0,"command":"def printEval(df, labelCol = \"error\", rawPredictionCol = \"rawPrediction\"):\n  evaluator = BinaryClassificationEvaluator()\n  evaluator.setLabelCol(labelCol)\n  evaluator.setRawPredictionCol(rawPredictionCol)\n\n  auroc = evaluator.setMetricName(\"areaUnderROC\").evaluate(df)\n  aupr = evaluator.setMetricName(\"areaUnderPR\").evaluate(df)\n  print(\"AUROC: {}\\nAUPR: {}\".format(auroc, aupr))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547173725730,"submitTime":1547173725708,"finishTime":1547173725752,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"20c7b034-e248-45ef-8168-4b0ff3240efe"},{"version":"CommandV1","origId":2949404636186020,"guid":"ad1a5cfd-b7b1-46ad-b3cc-32dc25961f43","subtype":"command","commandType":"auto","position":57.0,"command":"printEval(predictedDF)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">AUROC: 0.9691911699152626\nAUPR: 0.4458930347445656\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547173728331,"submitTime":1547173728299,"finishTime":1547173739297,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"44d6a6c8-5e9d-4633-9c55-dbb873712ee7"},{"version":"CommandV1","origId":2949404636186021,"guid":"833fe8c3-4928-4d69-9af5-8e87ada48e37","subtype":"command","commandType":"auto","position":58.0,"command":"%md\n##Conclusion\nHmmmm... our results are not great yet. We'll look into how to improve our results later.  ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"56daedec-1adb-4126-81ea-2505a80f1521"},{"version":"CommandV1","origId":2949404636186022,"guid":"66fa09a1-14e1-4b4a-b6f2-dfcb48623118","subtype":"command","commandType":"auto","position":59.0,"command":"%md-sandbox\n&copy; 2018 Databricks, Inc. All rights reserved.<br/>\nApache, Apache Spark, Spark and the Spark logo are trademarks of the <a href=\"http://www.apache.org/\">Apache Software Foundation</a>.<br/>\n<br/>\n<a href=\"https://databricks.com/privacy-policy\">Privacy Policy</a> | <a href=\"https://databricks.com/terms-of-use\">Terms of Use</a> | <a href=\"http://help.databricks.com/\">Support</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8056f952-a081-4c41-8fcd-f1ef13e15348"},{"version":"CommandV1","origId":2949404636186024,"guid":"9715dddd-98f0-4fd0-ac81-a8140f808f31","subtype":"command","commandType":"auto","position":6.5,"command":"os.listdir(data_dir)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">3</span><span class=\"ansired\">]: </span>[&apos;X_test.csv&apos;, &apos;X_train.csv&apos;, &apos;y_test.csv&apos;, &apos;y_train.csv&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547172213412,"submitTime":1547172197313,"finishTime":1547172213483,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4ac04d59-c82d-4d6c-9ec5-ca7a3f49c262"},{"version":"CommandV1","origId":2949404636186025,"guid":"153f8c4c-1474-48e9-88e4-b1251cb94263","subtype":"command","commandType":"auto","position":6.75,"command":"X_train = spark.read.option(\"header\", \"true\").option(\"inferSchema\", \"true\").csv(os.path.join('/tmp/data', 'X_train.csv'), header=\"true\")\nX_test = spark.read.option(\"header\", \"true\").option(\"inferSchema\", \"true\").csv(os.path.join('/tmp/data', 'X_test.csv'), header=\"true\")\ny_train = spark.read.option(\"header\", \"true\").option(\"inferSchema\", \"true\").csv(os.path.join('/tmp/data', 'y_train.csv'), header=\"true\")\ny_test = spark.read.option(\"header\", \"true\").option(\"inferSchema\", \"true\").csv(os.path.join('/tmp/data', 'y_test.csv'), header=\"true\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"X_train","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"volt_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"e_1","nullable":true,"type":"double"},{"metadata":{},"name":"e_2","nullable":true,"type":"double"},{"metadata":{},"name":"e_3","nullable":true,"type":"double"},{"metadata":{},"name":"e_4","nullable":true,"type":"double"},{"metadata":{},"name":"e_5","nullable":true,"type":"double"},{"metadata":{},"name":"de_1","nullable":true,"type":"double"},{"metadata":{},"name":"de_2","nullable":true,"type":"double"},{"metadata":{},"name":"de_3","nullable":true,"type":"double"},{"metadata":{},"name":"de_4","nullable":true,"type":"double"},{"metadata":{},"name":"de_5","nullable":true,"type":"double"},{"metadata":{},"name":"m_1","nullable":true,"type":"double"},{"metadata":{},"name":"m_2","nullable":true,"type":"double"},{"metadata":{},"name":"m_3","nullable":true,"type":"double"},{"metadata":{},"name":"m_4","nullable":true,"type":"double"},{"metadata":{},"name":"dm_1","nullable":true,"type":"double"},{"metadata":{},"name":"dm_2","nullable":true,"type":"double"},{"metadata":{},"name":"dm_3","nullable":true,"type":"double"},{"metadata":{},"name":"dm_4","nullable":true,"type":"double"},{"metadata":{},"name":"df_1","nullable":true,"type":"double"},{"metadata":{},"name":"df_2","nullable":true,"type":"double"},{"metadata":{},"name":"df_3","nullable":true,"type":"double"},{"metadata":{},"name":"df_4","nullable":true,"type":"double"},{"metadata":{},"name":"age","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null},{"name":"X_test","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"volt_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"e_1","nullable":true,"type":"double"},{"metadata":{},"name":"e_2","nullable":true,"type":"double"},{"metadata":{},"name":"e_3","nullable":true,"type":"double"},{"metadata":{},"name":"e_4","nullable":true,"type":"double"},{"metadata":{},"name":"e_5","nullable":true,"type":"double"},{"metadata":{},"name":"de_1","nullable":true,"type":"double"},{"metadata":{},"name":"de_2","nullable":true,"type":"double"},{"metadata":{},"name":"de_3","nullable":true,"type":"double"},{"metadata":{},"name":"de_4","nullable":true,"type":"double"},{"metadata":{},"name":"de_5","nullable":true,"type":"double"},{"metadata":{},"name":"m_1","nullable":true,"type":"double"},{"metadata":{},"name":"m_2","nullable":true,"type":"double"},{"metadata":{},"name":"m_3","nullable":true,"type":"double"},{"metadata":{},"name":"m_4","nullable":true,"type":"double"},{"metadata":{},"name":"dm_1","nullable":true,"type":"double"},{"metadata":{},"name":"dm_2","nullable":true,"type":"double"},{"metadata":{},"name":"dm_3","nullable":true,"type":"double"},{"metadata":{},"name":"dm_4","nullable":true,"type":"double"},{"metadata":{},"name":"df_1","nullable":true,"type":"double"},{"metadata":{},"name":"df_2","nullable":true,"type":"double"},{"metadata":{},"name":"df_3","nullable":true,"type":"double"},{"metadata":{},"name":"df_4","nullable":true,"type":"double"},{"metadata":{},"name":"age","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null},{"name":"y_train","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"y_1","nullable":true,"type":"integer"},{"metadata":{},"name":"y_2","nullable":true,"type":"integer"},{"metadata":{},"name":"y_3","nullable":true,"type":"integer"},{"metadata":{},"name":"y_4","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null},{"name":"y_test","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"y_1","nullable":true,"type":"integer"},{"metadata":{},"name":"y_2","nullable":true,"type":"integer"},{"metadata":{},"name":"y_3","nullable":true,"type":"integer"},{"metadata":{},"name":"y_4","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547172213497,"submitTime":1547172197868,"finishTime":1547172228208,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"98099b74-cacf-4345-8e68-aebde27560be"},{"version":"CommandV1","origId":2949404636186026,"guid":"31397b75-d5fa-4c55-88e2-9beb7cc393dd","subtype":"command","commandType":"auto","position":6.875,"command":"display(y_train)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"y_1","type":"\"integer\"","metadata":"{}"},{"name":"y_2","type":"\"integer\"","metadata":"{}"},{"name":"y_3","type":"\"integer\"","metadata":"{}"},{"name":"y_4","type":"\"integer\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1547172228222,"submitTime":1547172198404,"finishTime":1547172229321,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e4d5d885-5a87-4d27-8808-f89a7f25611b"},{"version":"CommandV1","origId":2949404636186027,"guid":"a1e34162-568a-4121-9557-6fdaed83b652","subtype":"command","commandType":"auto","position":6.9375,"command":"from pyspark.sql.types import StructType, StructField, LongType\n\ndef with_column_index(df): \n    new_schema = StructType(df.schema.fields + [StructField(\"ColumnIndex\", LongType(), False),])\n    return df.rdd.zipWithIndex().map(lambda row: row[0] + (row[1],)).toDF(schema=new_schema)\n\nX_train_ci = with_column_index(X_train)\ny_train_ci = with_column_index(y_train)\ntrainDF = X_train_ci.join(y_train_ci, X_train_ci.ColumnIndex == y_train_ci.ColumnIndex, 'inner').drop(\"ColumnIndex\").cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"X_train_ci","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"volt_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"e_1","nullable":true,"type":"double"},{"metadata":{},"name":"e_2","nullable":true,"type":"double"},{"metadata":{},"name":"e_3","nullable":true,"type":"double"},{"metadata":{},"name":"e_4","nullable":true,"type":"double"},{"metadata":{},"name":"e_5","nullable":true,"type":"double"},{"metadata":{},"name":"de_1","nullable":true,"type":"double"},{"metadata":{},"name":"de_2","nullable":true,"type":"double"},{"metadata":{},"name":"de_3","nullable":true,"type":"double"},{"metadata":{},"name":"de_4","nullable":true,"type":"double"},{"metadata":{},"name":"de_5","nullable":true,"type":"double"},{"metadata":{},"name":"m_1","nullable":true,"type":"double"},{"metadata":{},"name":"m_2","nullable":true,"type":"double"},{"metadata":{},"name":"m_3","nullable":true,"type":"double"},{"metadata":{},"name":"m_4","nullable":true,"type":"double"},{"metadata":{},"name":"dm_1","nullable":true,"type":"double"},{"metadata":{},"name":"dm_2","nullable":true,"type":"double"},{"metadata":{},"name":"dm_3","nullable":true,"type":"double"},{"metadata":{},"name":"dm_4","nullable":true,"type":"double"},{"metadata":{},"name":"df_1","nullable":true,"type":"double"},{"metadata":{},"name":"df_2","nullable":true,"type":"double"},{"metadata":{},"name":"df_3","nullable":true,"type":"double"},{"metadata":{},"name":"df_4","nullable":true,"type":"double"},{"metadata":{},"name":"age","nullable":true,"type":"integer"},{"metadata":{},"name":"ColumnIndex","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null},{"name":"y_train_ci","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"y_1","nullable":true,"type":"integer"},{"metadata":{},"name":"y_2","nullable":true,"type":"integer"},{"metadata":{},"name":"y_3","nullable":true,"type":"integer"},{"metadata":{},"name":"y_4","nullable":true,"type":"integer"},{"metadata":{},"name":"ColumnIndex","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null},{"name":"trainDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"volt_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"e_1","nullable":true,"type":"double"},{"metadata":{},"name":"e_2","nullable":true,"type":"double"},{"metadata":{},"name":"e_3","nullable":true,"type":"double"},{"metadata":{},"name":"e_4","nullable":true,"type":"double"},{"metadata":{},"name":"e_5","nullable":true,"type":"double"},{"metadata":{},"name":"de_1","nullable":true,"type":"double"},{"metadata":{},"name":"de_2","nullable":true,"type":"double"},{"metadata":{},"name":"de_3","nullable":true,"type":"double"},{"metadata":{},"name":"de_4","nullable":true,"type":"double"},{"metadata":{},"name":"de_5","nullable":true,"type":"double"},{"metadata":{},"name":"m_1","nullable":true,"type":"double"},{"metadata":{},"name":"m_2","nullable":true,"type":"double"},{"metadata":{},"name":"m_3","nullable":true,"type":"double"},{"metadata":{},"name":"m_4","nullable":true,"type":"double"},{"metadata":{},"name":"dm_1","nullable":true,"type":"double"},{"metadata":{},"name":"dm_2","nullable":true,"type":"double"},{"metadata":{},"name":"dm_3","nullable":true,"type":"double"},{"metadata":{},"name":"dm_4","nullable":true,"type":"double"},{"metadata":{},"name":"df_1","nullable":true,"type":"double"},{"metadata":{},"name":"df_2","nullable":true,"type":"double"},{"metadata":{},"name":"df_3","nullable":true,"type":"double"},{"metadata":{},"name":"df_4","nullable":true,"type":"double"},{"metadata":{},"name":"age","nullable":true,"type":"integer"},{"metadata":{},"name":"y_1","nullable":true,"type":"integer"},{"metadata":{},"name":"y_2","nullable":true,"type":"integer"},{"metadata":{},"name":"y_3","nullable":true,"type":"integer"},{"metadata":{},"name":"y_4","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547172229339,"submitTime":1547172198831,"finishTime":1547172232692,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"782f0f8a-a078-46ab-b64e-52013477745a"},{"version":"CommandV1","origId":2949404636186028,"guid":"d6001318-528c-41cc-9dab-97c57bcd0206","subtype":"command","commandType":"auto","position":6.96875,"command":"from pyspark.sql.types import StructType, StructField, LongType\n\ndef with_column_index(df): \n    new_schema = StructType(df.schema.fields + [StructField(\"ColumnIndex\", LongType(), False),])\n    return df.rdd.zipWithIndex().map(lambda row: row[0] + (row[1],)).toDF(schema=new_schema)\n\nX_test_ci = with_column_index(X_test)\ny_test_ci = with_column_index(y_test)\ntestDF = X_test_ci.join(y_test_ci, X_test_ci.ColumnIndex == y_test_ci.ColumnIndex, 'inner').drop(\"ColumnIndex\").cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"X_test_ci","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"volt_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"e_1","nullable":true,"type":"double"},{"metadata":{},"name":"e_2","nullable":true,"type":"double"},{"metadata":{},"name":"e_3","nullable":true,"type":"double"},{"metadata":{},"name":"e_4","nullable":true,"type":"double"},{"metadata":{},"name":"e_5","nullable":true,"type":"double"},{"metadata":{},"name":"de_1","nullable":true,"type":"double"},{"metadata":{},"name":"de_2","nullable":true,"type":"double"},{"metadata":{},"name":"de_3","nullable":true,"type":"double"},{"metadata":{},"name":"de_4","nullable":true,"type":"double"},{"metadata":{},"name":"de_5","nullable":true,"type":"double"},{"metadata":{},"name":"m_1","nullable":true,"type":"double"},{"metadata":{},"name":"m_2","nullable":true,"type":"double"},{"metadata":{},"name":"m_3","nullable":true,"type":"double"},{"metadata":{},"name":"m_4","nullable":true,"type":"double"},{"metadata":{},"name":"dm_1","nullable":true,"type":"double"},{"metadata":{},"name":"dm_2","nullable":true,"type":"double"},{"metadata":{},"name":"dm_3","nullable":true,"type":"double"},{"metadata":{},"name":"dm_4","nullable":true,"type":"double"},{"metadata":{},"name":"df_1","nullable":true,"type":"double"},{"metadata":{},"name":"df_2","nullable":true,"type":"double"},{"metadata":{},"name":"df_3","nullable":true,"type":"double"},{"metadata":{},"name":"df_4","nullable":true,"type":"double"},{"metadata":{},"name":"age","nullable":true,"type":"integer"},{"metadata":{},"name":"ColumnIndex","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null},{"name":"y_test_ci","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"y_1","nullable":true,"type":"integer"},{"metadata":{},"name":"y_2","nullable":true,"type":"integer"},{"metadata":{},"name":"y_3","nullable":true,"type":"integer"},{"metadata":{},"name":"y_4","nullable":true,"type":"integer"},{"metadata":{},"name":"ColumnIndex","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null},{"name":"testDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"volt_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"e_1","nullable":true,"type":"double"},{"metadata":{},"name":"e_2","nullable":true,"type":"double"},{"metadata":{},"name":"e_3","nullable":true,"type":"double"},{"metadata":{},"name":"e_4","nullable":true,"type":"double"},{"metadata":{},"name":"e_5","nullable":true,"type":"double"},{"metadata":{},"name":"de_1","nullable":true,"type":"double"},{"metadata":{},"name":"de_2","nullable":true,"type":"double"},{"metadata":{},"name":"de_3","nullable":true,"type":"double"},{"metadata":{},"name":"de_4","nullable":true,"type":"double"},{"metadata":{},"name":"de_5","nullable":true,"type":"double"},{"metadata":{},"name":"m_1","nullable":true,"type":"double"},{"metadata":{},"name":"m_2","nullable":true,"type":"double"},{"metadata":{},"name":"m_3","nullable":true,"type":"double"},{"metadata":{},"name":"m_4","nullable":true,"type":"double"},{"metadata":{},"name":"dm_1","nullable":true,"type":"double"},{"metadata":{},"name":"dm_2","nullable":true,"type":"double"},{"metadata":{},"name":"dm_3","nullable":true,"type":"double"},{"metadata":{},"name":"dm_4","nullable":true,"type":"double"},{"metadata":{},"name":"df_1","nullable":true,"type":"double"},{"metadata":{},"name":"df_2","nullable":true,"type":"double"},{"metadata":{},"name":"df_3","nullable":true,"type":"double"},{"metadata":{},"name":"df_4","nullable":true,"type":"double"},{"metadata":{},"name":"age","nullable":true,"type":"integer"},{"metadata":{},"name":"y_1","nullable":true,"type":"integer"},{"metadata":{},"name":"y_2","nullable":true,"type":"integer"},{"metadata":{},"name":"y_3","nullable":true,"type":"integer"},{"metadata":{},"name":"y_4","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547172245141,"submitTime":1547172245102,"finishTime":1547172246113,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9b7ed8d1-6249-4279-81e1-42596dc836d5"},{"version":"CommandV1","origId":2949404636186029,"guid":"971a44f9-35f9-47d4-9c2e-49d585270928","subtype":"script","commandType":"auto","position":4.333333333333333,"command":"","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"\n  <div>Successfully created class variables and utility functions.</div>\n  <li><b>username</b>: wopauli@microsoft.com</li>\n  <li><b>userhome</b>: dbfs:/user/wopauli@microsoft.com</li>\n","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547172205545,"submitTime":0,"finishTime":1547172212484,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["ab8200e3-c7b5-4986-aca3-83665741fceb"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ce0e922e-bcd4-490b-86ff-635da9c343b4"},{"version":"CommandV1","origId":2949404636186030,"guid":"de4f6648-d168-4feb-b457-fd3920eb7da7","subtype":"script","commandType":"auto","position":4.666666666666667,"command":"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547172212581,"submitTime":0,"finishTime":1547172212675,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["ab8200e3-c7b5-4986-aca3-83665741fceb"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b2c2a873-4b79-4043-988c-46292a75c2a3"},{"version":"CommandV1","origId":2949404636186032,"guid":"dd9908f5-19d7-44dc-bfcc-d45b2ed47a2e","subtype":"command","commandType":"auto","position":41.5,"command":"from pyspark.ml.feature import VectorAssembler, VectorIndexer\n\nfeaturesCols = trainDF.columns[:-1] # Removes labels\n\nvectorAssembler = VectorAssembler(inputCols=featuresCols, outputCol=\"rawFeatures\")\n\nvectorIndexer = VectorIndexer(inputCol=\"rawFeatures\", outputCol=\"features\", maxCategories=4)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547173098207,"submitTime":1547173098184,"finishTime":1547173098252,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cef7ef9c-b370-4276-902b-9e57bd7693b1"},{"version":"CommandV1","origId":2949404636186033,"guid":"2b382bea-23bc-4d70-9872-8e7b49ccf620","subtype":"command","commandType":"auto","position":46.5,"command":"from pyspark.ml import Pipeline\n\npipeline = Pipeline(stages = [vectorAssembler, vectorIndexer, lr])\n\npipeline.getStages()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">43</span><span class=\"ansired\">]: </span>\n[VectorAssembler_ad6416bf81c1,\n VectorIndexer_5e1534d11030,\n LogisticRegression_7643785b08d7]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547179719707,"submitTime":1547179719674,"finishTime":1547179719728,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1fd4bb9b-6c5a-44f0-a592-224d55c7b7ca"},{"version":"CommandV1","origId":2949404636186034,"guid":"777607d4-381e-4128-a24c-20f4cc4903b2","subtype":"command","commandType":"auto","position":47.5,"command":"cvModel = pipeline.fit(trainDF)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547173276340,"submitTime":1547173276307,"finishTime":1547173334599,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ae1ddfed-a2d3-4360-823c-ec4a2e093286"},{"version":"CommandV1","origId":2949404636186035,"guid":"23d5ed78-2593-4e3d-bb1e-eefc155cd7eb","subtype":"command","commandType":"auto","position":51.5,"command":"# TODO: Replace <FILL_IN> with appropriate code\npredictedDF = cvModel.transform(testDF)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"predictedDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"volt_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_3","nullable":true,"type":"double"},{"metadata":{},"name":"volt_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_ma_12","nullable":true,"type":"double"},{"metadata":{},"name":"volt_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"rotate_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"pressure_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"vibration_sd_12","nullable":true,"type":"double"},{"metadata":{},"name":"e_1","nullable":true,"type":"double"},{"metadata":{},"name":"e_2","nullable":true,"type":"double"},{"metadata":{},"name":"e_3","nullable":true,"type":"double"},{"metadata":{},"name":"e_4","nullable":true,"type":"double"},{"metadata":{},"name":"e_5","nullable":true,"type":"double"},{"metadata":{},"name":"de_1","nullable":true,"type":"double"},{"metadata":{},"name":"de_2","nullable":true,"type":"double"},{"metadata":{},"name":"de_3","nullable":true,"type":"double"},{"metadata":{},"name":"de_4","nullable":true,"type":"double"},{"metadata":{},"name":"de_5","nullable":true,"type":"double"},{"metadata":{},"name":"m_1","nullable":true,"type":"double"},{"metadata":{},"name":"m_2","nullable":true,"type":"double"},{"metadata":{},"name":"m_3","nullable":true,"type":"double"},{"metadata":{},"name":"m_4","nullable":true,"type":"double"},{"metadata":{},"name":"dm_1","nullable":true,"type":"double"},{"metadata":{},"name":"dm_2","nullable":true,"type":"double"},{"metadata":{},"name":"dm_3","nullable":true,"type":"double"},{"metadata":{},"name":"dm_4","nullable":true,"type":"double"},{"metadata":{},"name":"df_1","nullable":true,"type":"double"},{"metadata":{},"name":"df_2","nullable":true,"type":"double"},{"metadata":{},"name":"df_3","nullable":true,"type":"double"},{"metadata":{},"name":"df_4","nullable":true,"type":"double"},{"metadata":{},"name":"age","nullable":true,"type":"integer"},{"metadata":{},"name":"error","nullable":true,"type":"integer"},{"metadata":{"ml_attr":{"attrs":{"numeric":[{"idx":0,"name":"volt_ma_3"},{"idx":1,"name":"rotate_ma_3"},{"idx":2,"name":"pressure_ma_3"},{"idx":3,"name":"vibration_ma_3"},{"idx":4,"name":"volt_sd_3"},{"idx":5,"name":"rotate_sd_3"},{"idx":6,"name":"pressure_sd_3"},{"idx":7,"name":"vibration_sd_3"},{"idx":8,"name":"volt_ma_12"},{"idx":9,"name":"rotate_ma_12"},{"idx":10,"name":"pressure_ma_12"},{"idx":11,"name":"vibration_ma_12"},{"idx":12,"name":"volt_sd_12"},{"idx":13,"name":"rotate_sd_12"},{"idx":14,"name":"pressure_sd_12"},{"idx":15,"name":"vibration_sd_12"},{"idx":16,"name":"e_1"},{"idx":17,"name":"e_2"},{"idx":18,"name":"e_3"},{"idx":19,"name":"e_4"},{"idx":20,"name":"e_5"},{"idx":21,"name":"de_1"},{"idx":22,"name":"de_2"},{"idx":23,"name":"de_3"},{"idx":24,"name":"de_4"},{"idx":25,"name":"de_5"},{"idx":26,"name":"m_1"},{"idx":27,"name":"m_2"},{"idx":28,"name":"m_3"},{"idx":29,"name":"m_4"},{"idx":30,"name":"dm_1"},{"idx":31,"name":"dm_2"},{"idx":32,"name":"dm_3"},{"idx":33,"name":"dm_4"},{"idx":34,"name":"df_1"},{"idx":35,"name":"df_2"},{"idx":36,"name":"df_3"},{"idx":37,"name":"df_4"},{"idx":38,"name":"age"}]},"num_attrs":39}},"name":"rawFeatures","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{"ml_attr":{"attrs":{"binary":[{"idx":16,"name":"e_1","vals":["0.0","1.0"]},{"idx":17,"name":"e_2","vals":["0.0","1.0"]},{"idx":18,"name":"e_3","vals":["0.0","1.0"]},{"idx":19,"name":"e_4","vals":["0.0","1.0"]},{"idx":20,"name":"e_5","vals":["0.0","1.0"]},{"idx":26,"name":"m_1","vals":["0.0","1.0"]},{"idx":27,"name":"m_2","vals":["0.0","1.0"]},{"idx":28,"name":"m_3","vals":["0.0","1.0"]},{"idx":29,"name":"m_4","vals":["0.0","1.0"]}],"numeric":[{"idx":0,"name":"volt_ma_3"},{"idx":1,"name":"rotate_ma_3"},{"idx":2,"name":"pressure_ma_3"},{"idx":3,"name":"vibration_ma_3"},{"idx":4,"name":"volt_sd_3"},{"idx":5,"name":"rotate_sd_3"},{"idx":6,"name":"pressure_sd_3"},{"idx":7,"name":"vibration_sd_3"},{"idx":8,"name":"volt_ma_12"},{"idx":9,"name":"rotate_ma_12"},{"idx":10,"name":"pressure_ma_12"},{"idx":11,"name":"vibration_ma_12"},{"idx":12,"name":"volt_sd_12"},{"idx":13,"name":"rotate_sd_12"},{"idx":14,"name":"pressure_sd_12"},{"idx":15,"name":"vibration_sd_12"},{"idx":21,"name":"de_1"},{"idx":22,"name":"de_2"},{"idx":23,"name":"de_3"},{"idx":24,"name":"de_4"},{"idx":25,"name":"de_5"},{"idx":30,"name":"dm_1"},{"idx":31,"name":"dm_2"},{"idx":32,"name":"dm_3"},{"idx":33,"name":"dm_4"},{"idx":34,"name":"df_1"},{"idx":35,"name":"df_2"},{"idx":36,"name":"df_3"},{"idx":37,"name":"df_4"},{"idx":38,"name":"age"}]},"num_attrs":39}},"name":"features","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"rawPrediction","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"probability","nullable":true,"type":{"class":"org.apache.spark.ml.linalg.VectorUDT","pyClass":"pyspark.ml.linalg.VectorUDT","sqlType":{"fields":[{"metadata":{},"name":"type","nullable":false,"type":"byte"},{"metadata":{},"name":"size","nullable":true,"type":"integer"},{"metadata":{},"name":"indices","nullable":true,"type":{"containsNull":false,"elementType":"integer","type":"array"}},{"metadata":{},"name":"values","nullable":true,"type":{"containsNull":false,"elementType":"double","type":"array"}}],"type":"struct"},"type":"udt"}},{"metadata":{},"name":"prediction","nullable":false,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1547173463786,"submitTime":1547173463760,"finishTime":1547173463944,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wopauli@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d9f68633-d7a6-4009-b01e-d69d5a8a9037"}],"dashboards":[],"guid":"abc38e45-2d9c-4b3a-aa4f-8336c981af58","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}